<!-- Display GoatCounter pageviews in footer -->
<script>
  document.addEventListener('DOMContentLoaded', () => {
    const footerPv = document.getElementById('footer-pageviews');
    const footerTotal = document.getElementById('footer-totalviews');

    if (footerPv !== null && footerTotal !== null) {
      // Get current page path (empty string for homepage)
      const uri = location.pathname.replace(/\/$/, '');
      
      // Fetch page-specific views
      const pageUrl = `https://{{ site.analytics.goatcounter.id }}.goatcounter.com/counter/${encodeURIComponent(uri)}.json`;
      
      console.log('Fetching page views from:', pageUrl);
      
      fetch(pageUrl)
        .then((response) => {
          if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
          }
          return response.json();
        })
        .then((data) => {
          console.log('Page view data:', data);
          const count = data.count ? data.count.replace(/\D/g, '') : '0';
          footerPv.innerText = count ? new Intl.NumberFormat().format(count) : '0';
        })
        .catch((error) => {
          console.error('Error fetching page views:', error);
          footerPv.innerText = '0';
        });
      
      // Fetch total site views
      const totalUrl = `https://{{ site.analytics.goatcounter.id }}.goatcounter.com/counter/TOTAL.json`;
      
      console.log('Fetching total views from:', totalUrl);
      
      fetch(totalUrl)
        .then((response) => {
          if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
          }
          return response.json();
        })
        .then((data) => {
          console.log('Total view data:', data);
          const count = data.count ? data.count.replace(/\D/g, '') : '0';
          footerTotal.innerText = count ? new Intl.NumberFormat().format(count) : '0';
        })
        .catch((error) => {
          console.error('Error fetching total views:', error);
          footerTotal.innerText = '0';
        });
    }
  });
</script>